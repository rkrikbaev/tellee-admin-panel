(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,n,t){},1475:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),o=t(62),r=t.n(o),i=(t(263),t(17)),l=t(18),s=t(20),u=t(19),d=t(21),p=t(84),h=t(56),m=t(1489),f=(t(264),t(164),function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){return c.a.createElement("div",{className:"main_wrapper"},c.a.createElement("h1",null,"Home"),c.a.createElement("hr",null),c.a.createElement("p",null,"Here you can put everything your heart desires.",c.a.createElement("span",{role:"img","aria-label":"Hooray"},"\ud83d\ude42")))}}]),n}(a.Component)),E=(t(265),t(248)),C=t(1491),_=t(1490),v=t(1487),b=c.a.createElement("span",null,c.a.createElement(E.a,{avatar:!0,src:"http://zsse.zeinetsse.com/favicon.ico"})," User Admin"),g=[{key:"user",text:"Account",icon:"user"},{key:"settings",text:"Settings",icon:"settings"},{key:"sign-out",text:"Sign Out",icon:"sign out"}],O=function(e){function n(){return Object(i.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){return c.a.createElement("div",{id:"TopBar"},c.a.createElement(C.a,{clearing:!0,id:"top_menu"},c.a.createElement(_.a,{className:"topbar_left",floated:"left"},c.a.createElement("img",{className:"top_logo",alt:"Tellee_logo",src:"/Tellee_logo.svg"})),c.a.createElement(_.a,{className:"topbar_right",floated:"right"},c.a.createElement(v.a,{className:"top_dropdown",trigger:b,options:g,pointing:"top left",icon:null}))))}}]),n}(a.Component),T=t(7),P=t.n(T),S=t(15),j=(t(68),t(1488)),N=t(75),y=t(1486),R=t(1485),w=t(23),A=t(1484),x=t(1483),k=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).getThings=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){t.setState({oldThings:e})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.getConnections=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){t.setState({oldConnections:e})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.createThing=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(t.state.newThing)});case 2:case"end":return e.stop()}},e)})),t.createChannel=Object(S.a)(P.a.mark(function e(){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.channel,e.next=3,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({channel:n})});case 3:case"end":return e.stop()}},e)})),t.createAppConnection=Object(S.a)(P.a.mark(function e(){var n,a,c,o,r,i,l,s,u,d;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,a=n.newThing,c=n.connectionName,e.prev=1,o=[],e.next=5,t.createChannel();case 5:return e.next=7,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 7:return o=e.sent,r=o.filter(function(e){return e.name==="zsse/".concat(a.name)}),e.next=11,t.createThing();case 11:return e.next=13,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 13:o=e.sent,i=o.filter(function(e){return e.name==="zsse/".concat(a.name)}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.log(e.t0);case 20:return l={mac:a.metadata.mac,id:i[0].id,channels:"".concat(r[0].id),name:c},e.prev=21,e.next=24,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/create/app"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(l)});case 24:return e.next=26,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(r[0].id,"/things/").concat(i[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 26:return e.next=28,t.getConnections();case 28:s=t.state,u=s.showModalCreateApp,d=s.oldConnections,t.setState({showModalCreateApp:!1}),t.props.callbackFromParent(u,d),e.next=36;break;case 33:e.prev=33,e.t1=e.catch(21),console.log(e.t1);case 36:case"end":return e.stop()}},e,null,[[1,17],[21,33]])})),t.close=Object(S.a)(P.a.mark(function e(){var n,a,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.state,a=n.showModalCreateApp,c=n.oldConnections,t.setState({showModalCreateApp:!1}),t.props.callbackFromParent(a,c);case 3:case"end":return e.stop()}},e)})),t.handleChangeConnectionName=function(e){var n=e.target.value;0===t.state.oldConnections.filter(function(e){return e.name===n}).length&&t.regexpName.test(n)?t.setState(function(e){return{newThing:Object(w.a)({},e.newThing,{name:n}),channel:Object(w.a)({},e.channel,{name:n}),connectionName:n,isConnectionNameEnabled:!1}}):t.setState({isConnectionNameEnabled:!0})},t.handleChangeThingMac=function(e){var n=e.target.value;0===t.state.oldThings.filter(function(e){return e.metadata.mac===n}).length&&t.regexpMac.test(n)?t.setState(function(e){return{newThing:Object(w.a)({},e.newThing,{metadata:Object(w.a)({},e.newThing.metadata,{mac:n})}),isThingMacEnabled:!1}}):t.setState({isThingMacEnabled:!0})},t.state={showModalCreateApp:!1,isThingMacEnabled:!1,isConnectionNameEnabled:!1,oldThings:[],oldConnections:[],newThing:{name:"",metadata:{type:"app",mac:""}},channel:{name:"",metadata:{}},connectionName:""},t.regexpName=/^\w+$/,t.regexpMac=/^[0-9a-z]{1,2}([.:-])(?:[0-9a-z]{1,2}\1){4}[0-9a-z]{2}$/gim,t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getThings(),this.getConnections()}},{key:"render",value:function(){var e=this,n=this.props.showModalCreateApp,t=this.state,a=t.isThingMacEnabled,o=t.isConnectionNameEnabled;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:n,onClose:this.close},c.a.createElement(A.a.Header,null," CREATE APP "),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Name "),c.a.createElement("input",{placeholder:"name",onChange:function(n){return e.handleChangeConnectionName(n)},className:o?"show_error":""})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Mac "),c.a.createElement("input",{placeholder:"mac",onChange:function(n){return e.handleChangeThingMac(n)},className:a?"show_error":""})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"Cancel"),c.a.createElement(j.a,{positive:!0,icon:"plus",labelPosition:"right",content:"Create",disabled:a||o,onClick:this.createAppConnection})))}}]),n}(a.Component),U=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).getConfigById=function(){var e=Object(S.a)(P.a.mark(function e(n){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(n),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var n=[];e.content=JSON.parse(e.content);for(var a=0;a<e.mainflux_channels.length;a++)n.push(e.mainflux_channels[a].id);t.setState({selectedChannels:n,config:e})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.getChannels=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var n=e.map(function(e,n){return{value:e.id,text:e.name}});t.setState({channels:n})}).catch(function(e){return console.log(e)});case 1:case"end":return e.stop()}},e)})),t.editApp=Object(S.a)(P.a.mark(function e(){var n,a,c,o,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.config,a=t.state.config.content,c=a.mac,o=a.name,r={mac:c,id:n.mainflux_id,channels:n.mainflux_channels,name:o,type:"app",content:n.content},e.next=5,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(n.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:r})});case 5:t.close();case 6:case"end":return e.stop()}},e)})),t.close=function(){t.setState({showModalEditApp:!1}),t.props.callbackFromParent(t.state.showModalEditApp)},t.handleChangeName=function(e){var n=t.state.config;n.content.name=e.target.value,t.setState({config:n})},t.handleChangeChannel=function(e,n){var a=n.value,c=t.state.config;c.mainflux_channels=a,t.setState({config:c})},t.state={config:{},channels:[],selectedChannels:[],showModalEditApp:!1},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.connection!==this.props.connection&&this.getConfigById(e.connection.external_id)}},{key:"shouldComponentUpdate",value:function(e,n){return e!==this.props||n!==this.state}},{key:"componentDidMount",value:function(){this.getChannels()}},{key:"render",value:function(){var e=this,n=this.props.showModalEditApp,t=this.state,a=t.config,o=t.channels,r=t.selectedChannels;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:n,onClose:this.close},c.a.createElement(A.a.Header,null,"EDIT CONNECTION"),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Thing ID"),c.a.createElement("input",{placeholder:"mainflux_id",value:void 0!==a.content?a.mainflux_id:"",readOnly:!0})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Thing Key"),c.a.createElement("input",{placeholder:"mainflux_key",value:void 0!==a.content?a.mainflux_key:"",readOnly:!0})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Name"),c.a.createElement("input",{placeholder:"name",value:void 0!==a.content?a.content.name:"",onChange:function(n){return e.handleChangeName(n)}})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Channels"),c.a.createElement(v.a,{placeholder:"channels",multiple:!0,fluid:!0,selection:!0,options:o,onChange:this.handleChangeChannel,value:r})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"No"),c.a.createElement(j.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:this.editApp})))}}]),n}(a.Component),D=t(1482),M=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).getConnections=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){t.setState({oldConnections:e});var n=e.filter(function(e){return e.content=JSON.parse(e.content),"app"===e.content.type}).map(function(e){return{key:e.external_id,text:e.name,value:e.external_id}});t.setState({apps:n})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.getDeviceTypes=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://134.209.240.215:8300/devices").then(function(e){return e.json()}).then(function(e){var n=e.map(function(e,n){return{text:e,value:e}});t.setState({deviceTypes:n})}).catch(function(e){return console.log(e)});case 1:case"end":return e.stop()}},e)})),t.getThings=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){t.oldThings=e,t.setState({oldThings:e})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.createThing=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(t.state.newThing)});case 2:case"end":return e.stop()}},e)})),t.getChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var a,c,o,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.state.oldConnections,c=a.filter(function(e){return e.external_id===n}),e.next=4,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return o=e.sent,r=o.filter(function(e){return e.name===c[0].name}),e.abrupt("return",r[0]);case 7:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.getGlobalChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 2:return t=e.sent,a=t.filter(function(e){return e.name==="zsse/".concat(n)}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.createDeviceConnection=Object(S.a)(P.a.mark(function e(){var n,a,c,o,r,i,l,s,u,d,p,h,m,f;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,a=n.newThing,c=n.connectionName,o=n.config,r=o.cycle,i=o.sendToApp,l=o.device_type,s=o.app,e.prev=2,e.next=5,t.createThing();case 5:return e.next=7,t.getThings();case 7:u=t.oldThings.filter(function(e){return e.name==="zsse/".concat(a.name)}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:if(d={},p={},!i){e.next=21;break}return e.next=17,t.getChannel(s);case 17:p=e.sent,d={mac:a.metadata.mac,id:u[0].id,channel:p.id,name:c,cycle:r,sendToApp:i,device_type:l,app:s},e.next=25;break;case 21:return e.next=23,t.getGlobalChannel(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_CHANNEL_NAME);case 23:p=e.sent,d={mac:a.metadata.mac,id:u[0].id,channel:p.id,name:c,cycle:r,device_type:l,sendToApp:i};case 25:return e.prev=26,e.next=29,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/create/device"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(d)});case 29:if(!i){e.next=34;break}return e.next=32,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(s),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content),e.content.devices.push({device_name:"zsse/".concat(c),device_id:u[0].id,device_key:u[0].key,device_type:d.device_type}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(e.mainflux_channels[0].id,"/things/").concat(u[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 32:e.next=36;break;case 34:return e.next=36,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(p.id,"/things/").concat(u[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 36:return e.next=39,t.getConnections();case 39:h=t.state,m=h.showModalCreateDevice,f=h.oldConnections,t.setState({showModalCreateDevice:!1}),t.props.callbackFromParent(m,f),t.setState(function(e){return{config:Object(w.a)({},e.config,{sendToApp:!1})}}),e.next=48;break;case 45:e.prev=45,e.t1=e.catch(26),console.log(e.t1);case 48:case"end":return e.stop()}},e,null,[[2,10],[26,45]])})),t.close=Object(S.a)(P.a.mark(function e(){var n,a,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.state,a=n.showModalCreateDevice,c=n.oldConnections,t.setState({showModalCreateDevice:!1}),t.setState(function(e){return{config:Object(w.a)({},e.config,{sendToApp:!1})}}),t.props.callbackFromParent(a,c);case 4:case"end":return e.stop()}},e)})),t.closeError=function(){t.setState({showModalError:!1,errorText:""})},t.handleChangeConnectionName=function(e){var n=e.target.value;0===t.state.oldConnections.filter(function(e){return e.name==="zsse/".concat(n)}).length&&t.regexpName.test(n)?t.setState(function(e){return{newThing:Object(w.a)({},e.newThing,{name:n}),connectionName:n,isConnectionNameDisabled:!1}}):t.setState({isConnectionNameDisabled:!0})},t.handleChangeThingMac=function(e){var n=e.target.value;0===t.state.oldThings.filter(function(e){return e.metadata.mac===n}).length&&t.regexpMac.test(n)?t.setState(function(e){return{newThing:Object(w.a)({},e.newThing,{metadata:Object(w.a)({},e.newThing.metadata,{mac:n})}),isThingMacDisabled:!1}}):t.setState({isThingMacDisabled:!0})},t.handleChangeCycle=function(e){var n=e.target.value;t.setState(function(e){return{config:Object(w.a)({},e.config,{cycle:n}),isEnabled:e.config.cycle.length<=4&&/^\d+$/.test(e.config.cycle)}})},t.handleChangeSendToApp=function(e,n){var a=n.checked;t.setState(function(e){return{config:Object(w.a)({},e.config,{sendToApp:a})}}),t.getConnections()},t.handleChangeDeviceType=function(e,n){var a=n.value;t.setState(function(e){return{config:Object(w.a)({},e.config,{device_type:a})}})},t.handleChangeApp=function(e,n){var a=n.value;t.setState(function(e){return{config:Object(w.a)({},e.config,{app:a})}})},t.state={deviceTypes:[],apps:[],oldThings:[],oldConnections:[],isEnabled:!0,showModalCreateDevice:!1,isThingMacDisabled:!1,isConnectionNameDisabled:!1,newThing:{name:"",metadata:{type:"device",mac:""}},config:{id:"",channel:[],name:"",cycle:"",sendToApp:!1,device_type:void 0,app:void 0}},t.oldThings=[],t.regexpName=/^\w+$/,t.regexpMac=/^[0-9a-z]{1,2}([.:-])(?:[0-9a-z]{1,2}\1){4}[0-9a-z]{2}$/gim,t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(e){e!==this.props&&(this.getConnections(),this.getThings())}},{key:"componentDidMount",value:function(){this.getThings(),this.getConnections(),this.getDeviceTypes()}},{key:"render",value:function(){var e=this,n=this.props.showModalCreateDevice,t=this.state,a=t.isThingMacDisabled,o=t.isConnectionNameDisabled,r=t.isEnabled,i=t.deviceTypes,l=t.apps,s=t.config;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:n,onClose:this.close},c.a.createElement(A.a.Header,null," CREATE DEVICE "),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Name "),c.a.createElement("input",{placeholder:"name",onChange:function(n){return e.handleChangeConnectionName(n)},className:o?"show_error":""})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Mac "),c.a.createElement("input",{placeholder:"mac",onChange:function(n){return e.handleChangeThingMac(n)},className:a?"show_error":""})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Device type "),c.a.createElement(v.a,{placeholder:"type",fluid:!0,selection:!0,options:i,onChange:this.handleChangeDeviceType})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Cycle "),c.a.createElement("input",{placeholder:"cycle",className:r?"showSuccess":"showError",onChange:function(n){return e.handleChangeCycle(n)}})),c.a.createElement(x.a.Field,null,c.a.createElement(D.a,{label:s.sendToApp?"This device will be sent to App":"Click checkbox for send this config to App",onChange:this.handleChangeSendToApp})),c.a.createElement(x.a.Field,{className:s.sendToApp?"":"hide"},c.a.createElement("label",null,"Apps"),c.a.createElement(v.a,{placeholder:"apps",fluid:!0,selection:!0,options:l,onChange:this.handleChangeApp})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"Cancel"),c.a.createElement(j.a,{positive:!0,icon:"plus",labelPosition:"right",content:"Create",disabled:a||o||!r,onClick:this.createDeviceConnection})))}}]),n}(a.Component),L=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).getConfigById=function(){var e=Object(S.a)(P.a.mark(function e(n){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(n),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var n=e.content.app,a=e.content.device_type,c=e.content.sendToApp;t.setState({selectedApp:n,selectedDeviceType:a,config:e,handleSendToApp:c})}).catch(function(e){return console.log(e)});case 1:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.getThings=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var n=e.filter(function(e){return e.id===t.props.connection.mainflux_id});t.setState({currentThing:n[0]})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.getConnections=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var n=e.filter(function(e){return e.content=JSON.parse(e.content),"app"===e.content.type}).map(function(e){return{value:e.external_id,text:e.name.split(".")[0]}});t.setState({apps:n,oldConnections:e})}).catch(function(e){return console.log(e)});case 2:case"end":return e.stop()}},e)})),t.getDeviceTypes=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://134.209.240.215:8300/devices").then(function(e){return e.json()}).then(function(e){var n=e.map(function(e,n){return{text:e,value:e}});t.setState({deviceTypes:n})}).catch(function(e){return console.log(e)});case 1:case"end":return e.stop()}},e)})),t.getChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var a,c,o,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.state.oldConnections,c=a.filter(function(e){return e.external_id===n}),e.next=4,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return o=e.sent,r=o.filter(function(e){return e.name===c[0].name}),e.abrupt("return",r[0]);case 7:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.getGlobalChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 2:return t=e.sent,a=t.filter(function(e){return e.name==="zsse/".concat(n)}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.close=function(){t.setState({showModalEditDevice:!1}),t.props.callbackFromParent(t.state.showModalEditDevice)},t.editDevice=Object(S.a)(P.a.mark(function e(){var n,a,c,o,r,i,l,s,u,d,p,h,m,f;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,a=n.config,c=n.oldConnections,o=n.handleSendToApp,r=t.state.config.content,i=r.name,l=r.cycle,s=r.device_type,u=r.app,d=r.sendToApp,p=r.mac,h={},e.next=5,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things/").concat(a.mainflux_id),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(){var e=Object(S.a)(P.a.mark(function e(n){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things/edit/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({name:i,metadata:n.metadata})});case 2:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}());case 5:if(m={},!o){e.next=13;break}return e.next=9,t.getChannel(u);case 9:m=e.sent,h={type:"device",id:a.mainflux_id,mac:p,channel:m.id,sendToApp:o,name:i,cycle:l,device_type:s,app:u},e.next=17;break;case 13:return e.next=15,t.getGlobalChannel(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_CHANNEL_NAME);case 15:m=e.sent,h={type:"device",id:a.mainflux_id,mac:p,channel:m.id,sendToApp:o,name:i,device_type:s,cycle:l};case 17:return e.next=20,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:h})});case 20:return e.next=22,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/channels/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:h})});case 22:if(!0!==d||!1!==o){e.next=31;break}return e.next=25,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(u),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var n=e.content;n.devices=n.devices.filter(function(e){return e.device_id!==a.mainflux_id}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 25:return e.next=27,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(m.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 27:return t.close(),e.abrupt("return");case 31:if(!1!==d||!0!==o){e.next=38;break}return e.next=34,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(u),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content),e.content.devices.push({device_name:"zsse/".concat(h.name),device_id:a.mainflux_id,device_key:a.mainflux_key,device_type:h.device_type}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 34:return e.next=36,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(m.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 36:return e.next=38,t.getConnections();case 38:if(!d){e.next=46;break}if((f=c.filter(function(e){return e.mainflux_id===a.mainflux_id}))[0].content.app===h.app){e.next=44;break}return e.next=44,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(f[0].content.app),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var n=e.content;n.devices=n.devices.filter(function(e){return e.device_id!==f[0].mainflux_id}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(m.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 44:return e.next=46,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(u),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var n=e.content,t=n.devices.filter(function(e){return e.device_id===a.mainflux_id});if(0===t.length)n.devices.push({device_name:i,device_id:a.mainflux_id,device_key:a.mainflux_key,device_type:s});else{var c=n.devices.indexOf(t[0]);n.devices[c]={device_name:i,device_id:a.mainflux_id,device_key:a.mainflux_key,device_type:s}}fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/connection/create/channels/").concat(m.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 46:t.close();case 48:case"end":return e.stop()}},e)})),t.handleChangeConnectionName=function(e){var n=e.target.value;0!==t.state.oldConnections.filter(function(e){return e.name==="zsse/".concat(n)}).length?t.setState({isConnectionNameDisabled:!0}):t.setState(function(e){return{config:Object(w.a)({},e.config,{content:Object(w.a)({},e.config.content,{name:n})}),isConnectionNameDisabled:!1}})},t.handleChangeCycle=function(e){var n=e.target.value;t.setState(function(e){return{config:Object(w.a)({},e.config,{content:Object(w.a)({},e.config.content,{cycle:n})}),isEnabled:e.config.content.cycle.length<=4&&/^\d+$/.test(e.config.content.cycle)}})},t.handleChangeDeviceType=function(e,n){var a=n.value,c=a;t.setState(function(e){return{config:Object(w.a)({},e.config,{content:Object(w.a)({},e.config.content,{device_type:c})}),selectedDeviceType:a}})},t.handleChangeSendToApp=function(e,n){var a=n.checked;t.setState({handleSendToApp:a}),t.getConnections()},t.handleChangeApp=function(e,n){var a=n.value,c=a;t.setState(function(e){return{config:Object(w.a)({},e.config,{content:Object(w.a)({},e.config.content,{app:c})}),selectedApp:a}})},t.state={showModalEditDevice:!1,isEnabled:!0,deviceTypes:[],apps:[],config:{},selectedDeviceType:[],selectedApp:[],oldConnections:[],isConnectionNameDisabled:!1,handleSendToApp:void 0},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(e){var n=this;e.connection!==this.props.connection&&(this.getConfigById(e.connection.external_id),this.getThings().then(function(){n.forceUpdate()})),this.getConnections()}},{key:"shouldComponentUpdate",value:function(e,n){return e===this.props||n!==this.state}},{key:"componentDidMount",value:function(){this.getDeviceTypes(),this.getConnections()}},{key:"render",value:function(){var e=this,n=this.props.showModalEditDevice,t=this.state,a=t.config,o=t.isEnabled,r=t.deviceTypes,i=t.apps,l=t.selectedDeviceType,s=t.selectedApp,u=t.isConnectionNameDisabled,d=t.handleSendToApp;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:n,onClose:this.close},c.a.createElement(A.a.Header,null,"EDIT DEVICE"),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Thing ID"),c.a.createElement("input",{placeholder:"mainflux_id",value:void 0!==a.content?a.mainflux_id:"",readOnly:!0})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Thing Key"),c.a.createElement("input",{placeholder:"mainflux_key",value:void 0!==a.content?a.mainflux_key:"",readOnly:!0})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Name "),c.a.createElement("input",{placeholder:"name",onChange:function(n){return e.handleChangeConnectionName(n)},value:void 0!==a.content?a.content.name:"",className:u?"show_error":""})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Cycle "),c.a.createElement("input",{placeholder:"cycle",value:void 0!==a.content?a.content.cycle:"",className:o?"showSuccess":"showError",onChange:function(n){return e.handleChangeCycle(n)}})),c.a.createElement(x.a.Field,null,c.a.createElement("label",null," Device Type "),c.a.createElement(v.a,{placeholder:"device type",fluid:!0,selection:!0,options:r,value:l,onChange:this.handleChangeDeviceType})),c.a.createElement(x.a.Field,null,c.a.createElement(D.a,{label:d?"This device's config sent to App":"Click checkbox for send this device's config to App",onChange:this.handleChangeSendToApp,checked:d})),c.a.createElement(x.a.Field,{className:d?"":"hide"},c.a.createElement("label",null,"Apps"),c.a.createElement(v.a,{placeholder:"apps",fluid:!0,selection:!0,options:i,onChange:this.handleChangeApp,value:s})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"No"),c.a.createElement(j.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:this.editDevice,disabled:u||!o})))}}]),n}(a.Component),I=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).getChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 2:return t=e.sent,a=t.filter(function(e){return e.name===n}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.removeConnection=function(){var e=Object(S.a)(P.a.mark(function e(n){var a,c,o,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/things/remove/").concat(n.mainflux_id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/remove/").concat(n.mainflux_id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),a=n.content,c=a.sendToApp,o=a.app,!c){e.next=6;break}return e.next=6,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/").concat(o),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var t=e.content;t.devices=t.devices.filter(function(e){return e.device_id!==n.mainflux_id}),fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 6:return e.next=8,t.getChannel(n.name);case 8:r=e.sent,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels/remove/").concat(r.id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),t.setState({showModalRemove:!1}),t.props.callbackFromParent(t.state.showModalRemove,n.mainflux_id);case 12:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.close=function(){t.setState({showModalRemove:!1,isRemoveable:!0},function(){t.props.callbackFromParent(t.state.showModalRemove)})},t.state={showModalRemove:!1,isRemoveable:!0},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentWillReceiveProps",value:function(e){var n=e.connection.content;void 0!==n&&"app"===n.type&&0!==n.devices.length?this.setState({isRemoveable:!1}):this.setState({isRemoveable:!0})}},{key:"render",value:function(){var e=this,n=this.props,t=n.showModalRemove,a=n.connection,o=this.state.isRemoveable;return c.a.createElement(A.a,{basic:!0,size:"small",open:t},c.a.createElement(_.a,{icon:"archive",content:o?"REMOVE CONNECTION?":"CAN NOT REMOVE CONNECTION"}),c.a.createElement(A.a.Content,null,c.a.createElement("p",null,o?"Do you want to remove connection: ".concat(a.name):"CONNECTION '".concat(a.name,"' HAVE CONNECTED DEVICES. FIRST REMOVE CONNECTED DEVICES."))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},c.a.createElement(N.a,{name:"remove"})," No"),c.a.createElement(j.a,{color:"red",inverted:!0,onClick:function(){o?e.removeConnection(a):e.close()}},c.a.createElement(N.a,{name:"checkmark"})," Yes")))}}]),n}(a.Component),H=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).close=function(){t.setState({showModalRemove:!1}),t.props.callbackFromParent(t.state.showModalError)},t.state={showModalError:!1},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this.props,n=e.showModalError,t=e.errorText;return c.a.createElement(A.a,{basic:!0,size:"small",open:n},c.a.createElement(_.a,{icon:"archive",content:"ERROR"}),c.a.createElement(A.a.Content,null,c.a.createElement("p",null,t)),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},c.a.createElement(N.a,{name:"remove"})," Close")))}}]),n}(a.Component),V=function(e){function n(){var e;return Object(i.a)(this,n),(e=Object(s.a)(this,Object(u.a)(n).call(this))).getToken=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/users/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({email:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_MAINFLUX_USER)})});case 1:case"end":return e.stop()}},e)})),e.getConnections=Object(S.a)(P.a.mark(function n(){return P.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/bootstrap"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(n){var t=n.map(function(e){return e.content=JSON.parse(e.content),e});e.setState({connections:t})}).catch(function(e){return console.log(e)});case 2:case"end":return n.stop()}},n)})),e.createAppModalCallback=function(n,t){e.setState({showModalCreateApp:n,connections:t}),e.getConnections()},e.createDeviceModalCallback=function(n,t){e.setState({showModalCreateDevice:n,connections:t}),e.getConnections()},e.removeModalCallback=function(n,t){if(e.setState({showModalRemove:n}),t){var a=e.state.connections,c=a.filter(function(e){return e.mainflux_id===t})[0].content,o=c.type,r=c.app;if("device"===o&&void 0!==r){var i=a.filter(function(e){return e.external_id===r}),l=i[0].content.devices.filter(function(e){return e.device_id!==t});a[a.indexOf(i[0])].content.devices=l,e.setState({connections:a})}e.setState({connections:e.state.connections.filter(function(e){return e.mainflux_id!==t})})}},e.editAppModalCallback=function(n){e.setState({showModalEditApp:n}),e.getConnections()},e.editDeviceModalCallback=function(n){e.setState({showModalEditDevice:n}),e.getConnections()},e.errorModalCallback=function(n){e.setState({showModalError:n})},e.state={connections:[],showModalCreateApp:!1,showModalEditApp:!1,showModalCreateDevice:!1,showModalEditDevice:!1,showModalError:!1,edittingApp:{},edittingDevice:{},removingConnection:{},errorText:""},e}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getToken(),this.getConnections()}},{key:"componentWillReceiveProps",value:function(e){e!==this.props&&this.getConnections()}},{key:"render",value:function(){var e=this,n=this.state,t=n.connections,a=n.showModalCreateApp,o=n.showModalCreateDevice,r=n.showModalRemove,i=n.showModalEditApp,l=n.showModalEditDevice,s=n.showModalError,u=n.edittingApp,d=n.edittingDevice,p=n.removingConnection,h=n.errorText;return c.a.createElement("div",{id:"connections",className:"main_wrapper"},c.a.createElement("div",{className:"connection_top"},c.a.createElement("h1",null," Connections "),c.a.createElement("div",{className:"connection_btn__wrapper"},c.a.createElement(j.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreateApp:!0})}},c.a.createElement(N.a,{name:"chain"}),"Create App"),c.a.createElement(j.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreateDevice:!0})}},c.a.createElement(N.a,{name:"chain"}),"Create Device"))),c.a.createElement("hr",null),c.a.createElement(y.a.Group,{relaxed:!0},0===t.length?c.a.createElement("p",null,"Unfortunately we did not find your connections.",c.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")):t.map(function(n){return c.a.createElement(y.a,{key:n.mainflux_id},c.a.createElement(y.a.Content,{verticalAlign:"middle"},c.a.createElement(R.a,{content:c.a.createElement("div",null,c.a.createElement("p",null,"id: ",n.mainflux_id),c.a.createElement("p",null,"key: ",n.mainflux_key)),trigger:c.a.createElement(y.a.Header,null,n.name)}),c.a.createElement(y.a.Description,null,n.content.type),c.a.createElement(y.a.Description,null,n.external_id),c.a.createElement(y.a.Extra,null,c.a.createElement(j.a,{color:"red",floated:"right",icon:"trash alternate outline",labelPosition:"right",content:"Remove",onClick:function(){return e.setState({showModalRemove:!0,removingConnection:n})}}),c.a.createElement(j.a,{color:"yellow",floated:"right",icon:"edit outline",labelPosition:"right",content:"Edit",onClick:function(){return"app"===n.content.type?e.setState({showModalEditApp:!0,edittingApp:n}):e.setState({showModalEditDevice:!0,edittingDevice:n})}}))))})),c.a.createElement(k,{showModalCreateApp:a,callbackFromParent:this.createAppModalCallback}),c.a.createElement(M,{showModalCreateDevice:o,callbackFromParent:this.createDeviceModalCallback}),c.a.createElement(I,{showModalRemove:r,connection:p,callbackFromParent:this.removeModalCallback}),c.a.createElement(H,{showModalError:s,errorText:h,callbackFromParent:this.errorModalCallback}),c.a.createElement(U,{showModalEditApp:i,connection:u,callbackFromParent:this.editAppModalCallback}),c.a.createElement(L,{showModalEditDevice:l,connection:d,callbackFromParent:this.editDeviceModalCallback}))}}]),n}(a.Component),B=(t(109),function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).createChannel=function(){var e=Object(S.a)(P.a.mark(function e(n){var a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.state.channel,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({channel:a})}),t.close();case 3:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),t.close=function(){t.setState({showModalCreate:!1}),t.props.callbackFromParent(t.state.showModalCreate)},t.handleChangeName=function(e){var n=e.target.value;t.setState(function(e){return{channel:Object(w.a)({},e.channel,{name:n})}})},t.state={showModalCreate:!1,channel:{name:"",metadata:{}}},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this,n=this.props.showModalCreate,t=this.state.name;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:n,onClose:this.close},c.a.createElement(A.a.Header,null,"CREATE THING"),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Name"),c.a.createElement("input",{placeholder:"name",value:t,onChange:function(n){return e.handleChangeName(n)}})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"No"),c.a.createElement(j.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:function(){return e.createChannel(t)}})))}}]),n}(a.Component)),X=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).removeChannel=function(){var e=Object(S.a)(P.a.mark(function e(n,a){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels/remove/").concat(n),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),t.setState({showModalRemove:!1}),t.props.callbackFromParent(t.state.showModalRemove,n);case 3:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),t.close=function(){t.setState({showModalRemove:!1}),t.props.callbackFromParent(t.state.showModalRemove)},t.state={showModalRemove:!1},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.showModalRemove,a=n.channel;return c.a.createElement(A.a,{basic:!0,size:"small",open:t},c.a.createElement(_.a,{icon:"archive",content:"REMOVE CHANNEL?"}),c.a.createElement(A.a.Content,null,c.a.createElement("p",null,"Do you want to remove channel: ",a.name)),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},c.a.createElement(N.a,{name:"remove"})," No"),c.a.createElement(j.a,{color:"red",inverted:!0,onClick:function(n){e.removeChannel(a.id,n)}},c.a.createElement(N.a,{name:"checkmark"})," Yes")))}}]),n}(a.Component),F=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).editChannel=function(){var e=Object(S.a)(P.a.mark(function e(n,a){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels/edit/").concat(n.id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({name:n.name,metadata:n.metadata})}),t.close();case 2:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),t.show=function(){return t.setState({showModalEdit:!0})},t.close=function(){t.setState({showModalEdit:!1}),t.props.callbackFromParent(t.state.showModalEdit)},t.handleChangeName=function(e){var n=t.props.channel;n.name=e.target.value,t.props.callbackFromParent(!0,n)},t.state={showModalEdit:!1,name:e.channel.name},t}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.showModalEdit,a=n.channel;return c.a.createElement(A.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},c.a.createElement(A.a.Header,null,"EDIT CHANNEL"),c.a.createElement(A.a.Content,null,c.a.createElement(x.a,null,c.a.createElement(x.a.Field,null,c.a.createElement("label",null,"Name"),c.a.createElement("input",{placeholder:"name",value:a.name,onChange:function(n){return e.handleChangeName(n)}})))),c.a.createElement(A.a.Actions,null,c.a.createElement(j.a,{color:"black",onClick:this.close},"No"),c.a.createElement(j.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:function(){return e.editChannel(a)}})))}}]),n}(a.Component),J=function(e){function n(){var e;return Object(i.a)(this,n),(e=Object(s.a)(this,Object(u.a)(n).call(this))).getToken=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/users/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({email:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_MAINFLUX_USER)})});case 2:case"end":return e.stop()}},e)})),e.getChannels=Object(S.a)(P.a.mark(function n(){return P.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_EXPRESS_HOST,"/api/channels"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(n){return e.setState({channels:n})}).catch(function(e){return console.log(e)});case 2:case"end":return n.stop()}},n)})),e.removeModalCallback=function(n,t){e.setState({showModalRemove:n}),t&&e.setState({channels:e.state.channels.filter(function(e){return e.id!==t})})},e.editModalCallback=function(n){e.setState({showModalEdit:n})},e.createChannelModalCallback=function(){var n=Object(S.a)(P.a.mark(function n(t){return P.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.setState({showModalCreate:t}),n.next=3,e.getChannels();case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),e.state={channels:[],edittingChannel:{},removingChannel:{},showModalRemove:!1,showModalEdit:!1,showModalCreate:!1},e}return Object(d.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(S.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getToken();case 2:this.getChannels();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,n=this.state,t=n.channels,a=n.showModalEdit,o=n.showModalCreate,r=n.showModalRemove,i=n.removingChannel,l=n.edittingChannel;return c.a.createElement("div",{id:"channels",className:"main_wrapper"},c.a.createElement("div",{className:"channel_top"},c.a.createElement("h1",null,"Channels"),c.a.createElement(j.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreate:!0})}},c.a.createElement(N.a,{name:"podcast"}),"Create Channel")),c.a.createElement("hr",null),c.a.createElement(y.a.Group,{relaxed:!0},0===t.length?c.a.createElement("p",null,"Unfortunately we did not find your channels.",c.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")):t.map(function(n){return c.a.createElement(y.a,{key:n.id},c.a.createElement(y.a.Content,{verticalAlign:"middle"},c.a.createElement(y.a.Header,null,n.name),c.a.createElement(y.a.Description,null,n.id),c.a.createElement(y.a.Extra,null,c.a.createElement(j.a,{color:"red",floated:"right",icon:"trash alternate outline",labelPosition:"right",content:"Remove",onClick:function(){return e.setState({showModalRemove:!0,removingChannel:n})}}),c.a.createElement(j.a,{color:"yellow",floated:"right",icon:"edit outline",labelPosition:"right",content:"Edit",onClick:function(){return e.setState({showModalEdit:!0,edittingChannel:n})}}))))})),c.a.createElement(X,{showModalRemove:r,channel:i,callbackFromParent:this.removeModalCallback}),c.a.createElement(F,{showModalEdit:a,channel:l,callbackFromParent:this.editModalCallback}),c.a.createElement(B,{showModalCreate:o,callbackFromParent:this.createChannelModalCallback}))}}]),n}(a.Component),z=function(){return c.a.createElement("div",{className:"main_wrapper"},c.a.createElement("h1",null,"Nothing was found"),c.a.createElement("p",null,"Unfortunately we did not find anything for your request.",c.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")))},G=function(e){function n(){var e;return Object(i.a)(this,n),(e=Object(s.a)(this,Object(u.a)(n).call(this))).handleHome=function(){e.setState({home:!0,channels:!1,connections:!1})},e.handleChannels=function(){e.setState({home:!1,channels:!0,connections:!1})},e.handleConnections=function(){e.setState({home:!1,channels:!1,connections:!0})},e.state={home:!0,channels:!1,connections:!1},e}return Object(d.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this.state,n=e.home,t=e.channels,a=e.connections;return c.a.createElement("div",{className:"App"},c.a.createElement(O,null),c.a.createElement(p.a,null,c.a.createElement("div",{id:"sidebar_wrapper"},c.a.createElement(m.a,{id:"sidebar_menu",secondary:!0,vertical:!0},c.a.createElement("ul",null,c.a.createElement("li",{className:n?"active_item":""},c.a.createElement(p.b,{onClick:this.handleHome,to:"/"},"Home")),c.a.createElement("li",{className:t?"active_item":""},c.a.createElement(p.b,{onClick:this.handleChannels,to:"/channels"},"Channels")),c.a.createElement("li",{className:a?"active_item":""},c.a.createElement(p.b,{onClick:this.handleConnections,to:"/connections"},"Connections")))),c.a.createElement(h.c,null,c.a.createElement(h.a,{exact:!0,path:"/",component:f}),c.a.createElement(h.a,{path:"/channels",component:J}),c.a.createElement(h.a,{path:"/connections",component:V}),c.a.createElement(h.a,{component:z})))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},258:function(e,n,t){e.exports=t(1475)},263:function(e,n,t){},264:function(e,n,t){},68:function(e,n,t){}},[[258,1,2]]]);
//# sourceMappingURL=main.09f19e62.chunk.js.map