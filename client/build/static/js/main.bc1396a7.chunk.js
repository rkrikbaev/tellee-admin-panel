(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{181:function(e,t,n){},275:function(e,t,n){},299:function(e,t,n){e.exports=n.p+"static/media/turbine.06474a16.svg"},300:function(e,t,n){e.exports=n.p+"static/media/pump.1df4e95b.svg"},301:function(e,t,n){e.exports=n.p+"static/media/generator.7a7e96ae.svg"},325:function(e,t,n){e.exports=n.p+"static/media/edit.2927f8de.svg"},326:function(e,t,n){e.exports=n.p+"static/media/delete.650cdc57.svg"},365:function(e,t,n){e.exports=n(614)},374:function(e,t,n){},375:function(e,t,n){},523:function(e,t,n){},614:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(41),r=n.n(c),i=n(66),l=n(67),s=n(298),u=n(81),d=n(26),h="ADD_USER";function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var m={items:[2,3],user:{}};var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{items:[].concat(Object(u.a)(e.items),[t.payload])});default:return e}},v="SHOW_GRAPH_ACTION_WINDOW",g="ADD_GRAPH_CONFIG",b="TOGGLE_GRAPH_DRAGGING",y="DATA_REQUEST_STARTED",E="DATA_RECIEVE_SUCCESS",C="DATA_RECIEVE_FAILURE";function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j={defaultWidth:620,defaultHeight:350,showGraphActionWindow:!1,isGraphDraggable:!1,graphsConfigList:[{title:"My Ambient",type:"timeseries",device:"turbine",date:"24",parameter:"Ambient_temp"},{title:"My Inlete",type:"timeseries",device:"turbine",date:"24",parameter:"Inlete_temp"}],graphsData:[],loading:!1,error:null};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return w({},e,{showGraphActionWindow:t.payload});case g:return w({},e,{graphsConfigList:[].concat(Object(u.a)(e.graphsConfigList),[t.payload])});case b:return w({},e,{isGraphDraggable:t.payload});case y:return w({},e,{loading:!0});case E:return w({},e,{loading:!1,error:null,graphsData:[].concat(Object(u.a)(e.graphsData),[t.payload])});case C:return w({},e,{loading:!1,error:t.payload.error});default:return e}},_=Object(l.c)({users:f,graph:x}),k=[s.a],T=Object(l.e)(_,{},Object(l.d)(l.a.apply(void 0,k),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),D=(n(374),n(19)),M=n(20),S=n(22),N=n(21),P=n(23),A=n(102),F=n(70),R=n(631),U=(n(375),n(216),n(9)),B=n.n(U),W=n(16),G=n(629),I=function(e){return function(t){t({type:h,payload:e})}},L=n(299),J=n.n(L),z=n(300),H=n.n(z),V=n(301),K=n.n(V),$=["connected","not connected"],Y=[],X=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getToken=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/users/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({email:"".concat("zeinetsse11@email.com")})});case 2:case"end":return e.stop()}},e)})),n.getDevicesFromMainflux=function(){fetch("".concat("http://localhost:5000","/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){n.parseDataFromBootstrap(e)}).catch(function(e){return e})},n.parseDataFromBootstrap=function(e){var t=e.filter(function(e){return e.content=JSON.parse(e.content),"device"===e.content.type}).map(function(e){return{id:e.mainflux_id,icon:e.content.device_type,name:e.name,status:$[Math.floor(Math.random()*$.length)],ram:Math.floor(100*Math.random())+1,memory:"7976/".concat(Math.floor(7976*Math.random())+1)}});n.customizeDataForRender(t)},n.customizeDataForRender=function(e){e.forEach(function(e){switch(e.icon){case"turbine":e.icon=J.a;break;case"e-meter_v2":e.icon=H.a;break;case"e-meter_v1":e.icon=K.a}}),e.forEach(function(e){switch(e.status){case"connected":Y.push("green");break;case"not connected":Y.push("yellow")}}),n._isMounted&&n.setState({devices:e})},n.state={devices:[]},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.addUser("milk")}},{key:"componentDidMount",value:function(){var e=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._isMounted=!0,e.next=3,this.getToken();case 3:this.getDevicesFromMainflux();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this.state.devices;return o.a.createElement("div",{className:"main_wrapper"},o.a.createElement("h1",null,"Home"),o.a.createElement("hr",null),0!==e.length?o.a.createElement(G.a.Group,null,e.map(function(e,t){return o.a.createElement(G.a,{fluid:!0,color:Y[t],key:e.id,className:"home_card"},o.a.createElement("img",{src:e.icon,alt:"".concat(e.name),className:"home_card__item"}),o.a.createElement("p",{className:"home_card__item"},o.a.createElement("label",{className:"home_card__label",htmlFor:"name"},"name:"),e.name.toUpperCase()),o.a.createElement("p",{className:"home_card__item"},o.a.createElement("label",{className:"home_card__label",htmlFor:"status"},"status:"),e.status.toUpperCase()),o.a.createElement("p",{className:"home_card__item"},o.a.createElement("label",{className:"home_card__label",htmlFor:"cpu"},"CPU:"),e.ram,"%"),o.a.createElement("p",{className:"home_card__item"},o.a.createElement("label",{className:"home_card__label",htmlFor:"memory"},"memory:"),e.memory,"kB"))})):o.a.createElement("p",null,"Here you can put everything your heart desires.",o.a.createElement("span",{role:"img","aria-label":"Hooray"},"\ud83d\ude42")))}}]),t}(a.Component);var q=Object(i.b)(function(e){return{users:e.users.items}},function(e){return{addUser:function(t){return e(I(t))}}})(X),Q=n(328),Z=n(633),ee=n(632),te=n(628),ne=o.a.createElement("span",null,o.a.createElement(Q.a,{avatar:!0,src:"http://zsse.zeinetsse.com/favicon.ico"})," ","User Admin"),ae=[{key:"user",text:"Account",icon:"user"},{key:"settings",text:"Settings",icon:"settings"},{key:"sign-out",text:"Sign Out",icon:"sign out"}];function oe(){return o.a.createElement("div",{id:"TopBar"},o.a.createElement(Z.a,{clearing:!0,id:"top_menu"},o.a.createElement(ee.a,{className:"topbar_left",floated:"left"},o.a.createElement("img",{className:"top_logo",alt:"Tellee_logo",src:"/Tellee_logo.svg"})),o.a.createElement(ee.a,{className:"topbar_right",floated:"right"},o.a.createElement(te.a,{className:"top_dropdown",trigger:ne,options:ae,pointing:"top left",icon:null}))))}n(86);var ce=n(630),re=n(101),ie=n(627),le=n(623),se=n(626),ue=n(625),de=n(624);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var me={log:function(e){return console.log(e)}},fe=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getThings=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){n._isMounted&&n.setState({oldThings:e})}).catch(function(e){return me.log(e)});case 2:case"end":return e.stop()}},e)})),n.getConnections=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){n._isMounted&&n.setState({oldConnections:e})}).catch(function(e){return me.log(e)});case 2:case"end":return e.stop()}},e)})),n.createThing=Object(W.a)(B.a.mark(function e(){var t;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.newThing,e.next=3,fetch("".concat("http://localhost:5000","/api/things/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(t)});case 3:case"end":return e.stop()}},e)})),n.createChannel=Object(W.a)(B.a.mark(function e(){var t;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.channel,e.next=3,fetch("".concat("http://localhost:5000","/api/channels/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({channel:t})});case 3:case"end":return e.stop()}},e)})),n.createAppConnection=Object(W.a)(B.a.mark(function e(){var t,a,o,c,r,i,l,s,u,d,h;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,a=t.newThing,o=t.connectionName,c=n.props.callbackFromParent,e.prev=2,l=[],e.next=6,n.createChannel();case 6:return e.next=8,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return me.log(e)});case 8:return l=e.sent,r=l.filter(function(e){return e.name==="zsse/".concat(a.name)}),e.next=12,n.createThing();case 12:return e.next=14,fetch("".concat("http://localhost:5000","/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return me.log(e)});case 14:l=e.sent,i=l.filter(function(e){return e.name==="zsse/".concat(a.name)}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),me.log(e.t0);case 21:return s={mac:a.metadata.mac,id:i[0].id,channels:"".concat(r[0].id),name:o},e.prev=22,e.next=25,fetch("".concat("http://localhost:5000","/api/bootstrap/create/app"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(s)});case 25:return e.next=27,fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(r[0].id,"/things/").concat(i[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 27:return e.next=29,n.getConnections();case 29:u=n.state,d=u.showModalCreateApp,h=u.oldConnections,n._isMounted&&n.setState({showModalCreateApp:!1}),c(d,h),e.next=37;break;case 34:e.prev=34,e.t1=e.catch(22),me.log(e.t1);case 37:case"end":return e.stop()}},e,null,[[2,18],[22,34]])})),n.close=Object(W.a)(B.a.mark(function e(){var t,a,o,c;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.state,a=t.showModalCreateApp,o=t.oldConnections,c=n.props.callbackFromParent,n._isMounted&&n.setState({showModalCreateApp:!1}),c(a,o);case 4:case"end":return e.stop()}},e)})),n.handleChangeConnectionName=function(e){var t=n.state.oldConnections,a=e.target.value,o=t.filter(function(e){return e.name===a});0===o.length&&n.regexpName.test(a)||!n._isMounted?(0===o.length||n.regexpName.test(a))&&n._isMounted&&n.setState(function(e){return{newThing:pe({},e.newThing,{name:a}),channel:pe({},e.channel,{name:a}),connectionName:a,isConnectionNameEnabled:!1}}):n.setState({isConnectionNameEnabled:!0})},n.handleChangeThingMac=function(e){var t=n.state.oldThings,a=e.target.value,o=t.filter(function(e){return e.metadata.mac===a});0===o.length&&n.regexpMac.test(a)||!n._isMounted?(0===o.length||n.regexpMac.test(a))&&n._isMounted&&n.setState(function(e){return{newThing:pe({},e.newThing,{metadata:pe({},e.newThing.metadata,{mac:a})}),isThingMacEnabled:!1}}):n.setState({isThingMacEnabled:!0})},n.state={showModalCreateApp:!1,isThingMacEnabled:!1,isConnectionNameEnabled:!1,oldThings:[],oldConnections:[],newThing:{name:"",metadata:{type:"app",mac:""}},channel:{name:"",metadata:{}},connectionName:""},n.regexpName=/^\w+$/,n.regexpMac=/^[0-9a-z]{1,2}([.:-])(?:[0-9a-z]{1,2}\1){4}[0-9a-z]{2}$/gim,n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.getThings(),this.getConnections()}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.props===e&&this.state===t)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props.showModalCreateApp,n=this.state,a=n.isThingMacEnabled,c=n.isConnectionNameEnabled;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},o.a.createElement(ue.a.Header,null," CREATE APP "),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"}," Name "),o.a.createElement("input",{placeholder:"name",onChange:function(t){return e.handleChangeConnectionName(t)},className:c?"show_error":""})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mac"}," Mac "),o.a.createElement("input",{placeholder:"mac",onChange:function(t){return e.handleChangeThingMac(t)},className:a?"show_error":""})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:this.close},"Cancel"),o.a.createElement(ce.a,{positive:!0,icon:"plus",labelPosition:"right",content:"Create",disabled:a||c,onClick:this.createAppConnection})))}}]),t}(a.Component),ve={log:function(e){return console.log(e)}},ge=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getConfigById=function(){var e=Object(W.a)(B.a.mark(function e(t){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(t),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=[];e.content=JSON.parse(e.content);for(var a=0;a<e.mainflux_channels.length;a+=1)t.push(e.mainflux_channels[a].id);n._isMounted&&n.setState({selectedChannels:t,config:e})}).catch(function(e){return ve.log(e)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getChannels=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat("http://localhost:5000","/api/channels"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return{value:e.id,text:e.name}});n._isMounted&&n.setState({channels:t})}).catch(function(e){return ve.log(e)});case 1:case"end":return e.stop()}},e)})),n.editApp=Object(W.a)(B.a.mark(function e(){var t,a,o,c,r;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.config,a=t.content,o=a.mac,c=a.name,r={mac:o,id:t.mainflux_id,channels:t.mainflux_channels,name:c,type:"app",content:t.content},e.next=5,fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(t.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:r})});case 5:return e.next=7,fetch("".concat("http://localhost:5000","/api/channels/edit/").concat(r.channels[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({name:r.name,metadata:{}})});case 7:n.close();case 8:case"end":return e.stop()}},e)})),n.close=function(){var e=n.props.callbackFromParent,t=n.state.showModalEditApp;n._isMounted&&n.setState({showModalEditApp:!1}),e(t)},n.handleChangeName=function(e){var t=n.state.config;t.content.name=e.target.value,n._isMounted&&n.setState({config:t})},n.handleChangeChannel=function(e,t){var a=t.value,o=n.state.config;o.mainflux_channels=a,n._isMounted&&n.setState({config:o})},n.state={config:{},channels:[],selectedChannels:[],showModalEditApp:!1},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.connection;this._isMounted=!0,this.getConfigById(e.external_id),this.getChannels()}},{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props.showModalEditApp,n=this.state,a=n.config,c=n.channels,r=n.selectedChannels;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},o.a.createElement(ue.a.Header,null,"EDIT APPLICATION"),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_id"},"Thing ID"),o.a.createElement("input",{placeholder:"mainflux_id",value:void 0!==a.content?a.mainflux_id:"",readOnly:!0})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Thing Key"),o.a.createElement("input",{placeholder:"mainflux_key",value:void 0!==a.content?a.mainflux_key:"",readOnly:!0})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Name"),o.a.createElement("input",{placeholder:"name",value:void 0!==a.content?a.content.name:"",onChange:function(t){return e.handleChangeName(t)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"channels"},"Channels"),o.a.createElement(te.a,{placeholder:"channels",multiple:!0,fluid:!0,selection:!0,options:c,onChange:this.handleChangeChannel,value:r})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:this.close},"No"),o.a.createElement(ce.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:this.editApp})))}}]),t}(a.Component),be=n(622);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ce={title:"Turbine",subtitle:"LM2500",assettext:"MTU",assetvalue:"operation"},Oe={log:function(e){return console.log(e)}},we=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getConnections=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){n.setState({oldConnections:e});var t=e.filter(function(e){return e.content=JSON.parse(e.content),"app"===e.content.type}).map(function(e){return{key:e.external_id,text:e.name,value:e.external_id}});n._isMounted&&n.setState({apps:t})}).catch(function(e){return Oe.log(e)});case 2:case"end":return e.stop()}},e)})),n.getDeviceTypes=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://134.209.240.215:8300/devices").then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return{text:e,value:e}});n._isMounted&&n.setState({deviceTypes:t})}).catch(function(e){return Oe.log(e)});case 1:case"end":return e.stop()}},e)})),n.getThings=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/things"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){n.oldThings=e,n._isMounted&&n.setState({oldThings:e})}).catch(function(e){return Oe.log(e)});case 2:case"end":return e.stop()}},e)})),n.createThing=Object(W.a)(B.a.mark(function e(){var t;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.newThing,e.next=3,fetch("".concat("http://localhost:5000","/api/things/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(t)});case 3:case"end":return e.stop()}},e)})),n.getChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var a,o,c,r;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.oldConnections,o=[],c=a.filter(function(e){return e.external_id===t}),e.next=5,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return Oe.log(e)});case 5:return r=e.sent,o=r.filter(function(e){return e.name===c[0].name}),e.abrupt("return",o[0]);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getGlobalChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var n,a;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return Oe.log(e)});case 2:return n=e.sent,a=n.filter(function(e){return e.name==="zsse/".concat(t)}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.createDeviceConnection=Object(W.a)(B.a.mark(function e(){var t,a,o,c,r,i,l,s,u,d,h,p,m,f,v,g,b,y,E,C,O,w,j,x,_,k,T,D;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.callbackFromParent,a=n.state,o=a.newThing,c=a.connectionName,r=a.config,i=a.newDevice,l=r.cycle,s=r.sendToApp,u=r.sendToDB,d=r.deviceType,h=r.app,p=[],e.prev=4,e.next=7,n.createThing();case 7:return e.next=9,n.getThings();case 9:p=n.oldThings.filter(function(e){return e.name==="zsse/".concat(o.name)}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),Oe.log(e.t0);case 15:if(m={},f={},!s){e.next=24;break}return e.next=20,n.getChannel(h);case 20:f=e.sent,m={mac:o.metadata.mac,id:p[0].id,channel:f.id,name:c,cycle:l,sendToApp:s,sendToDB:u,deviceType:d,app:h},e.next=28;break;case 24:return e.next=26,n.getGlobalChannel("global_channel");case 26:f=e.sent,m={mac:o.metadata.mac,id:p[0].id,channel:f.id,name:c,cycle:l,deviceType:d,sendToApp:s,sendToDB:u};case 28:return e.prev=28,e.next=31,fetch("".concat("http://localhost:5000","/api/bootstrap/create/device"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(m)});case 31:if(!s){e.next=36;break}return e.next=34,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(h),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content),e.content.devices.push({device_name:"zsse/".concat(c),device_id:p[0].id,device_key:p[0].key,deviceType:m.deviceType}),fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(e.mainflux_channels[0].id,"/things/").concat(p[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 34:e.next=38;break;case 36:return e.next=38,fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(f.id,"/things/").concat(p[0].id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 38:if(!u){e.next=43;break}return v=i.title,g=i.subtitle,b=i.severity,y=i.alerttext,E=i.alertvalue,C=i.assettext,O=i.assetvalue,w=i.messagetext,j=i.longitude,x=i.latitude,_={id:o.name,title:v,subtitle:g,severity:b,alerttext:y,alertvalue:E,assettext:C,assetvalue:O,messagetext:w,longitude:j,latitude:x},e.next=43,fetch("".concat("http://localhost:5000","/api/device/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(_)});case 43:return e.next=45,n.getConnections();case 45:k=n.state,T=k.showModalCreateDevice,D=k.oldConnections,n._isMounted&&n.setState({showModalCreateDevice:!1}),t(T,D),n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{sendToApp:!1})}}),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(28),Oe.log(e.t1);case 54:case"end":return e.stop()}},e,null,[[4,12],[28,51]])})),n.close=Object(W.a)(B.a.mark(function e(){var t,a,o,c;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.props.callbackFromParent,a=n.state,o=a.showModalCreateDevice,c=a.oldConnections,n.setState({showModalCreateDevice:!1}),n.setState(function(e){return{config:Ee({},e.config,{sendToApp:!1})}}),t(o,c);case 5:case"end":return e.stop()}},e)})),n.handleChangeConnectionName=function(e){var t=n.state.oldConnections,a=e.target.value,o=t.filter(function(e){return e.name==="zsse/".concat(a)});0===o.length&&n.regexpName.test(a)||!n._isMounted?(0===o.length||n.regexpName.test(a))&&n._isMounted&&n.setState(function(e){return{newThing:Ee({},e.newThing,{name:a}),connectionName:a,isConnectionNameDisabled:!1}}):n._isMounted&&n.setState({isConnectionNameDisabled:!0})},n.handleChangeThingMac=function(e){var t=n.state.oldThings,a=e.target.value,o=t.filter(function(e){return e.metadata.mac===a});0===o.length&&n.regexpMac.test(a)||!n._isMounted?(0===o.length||n.regexpMac.test(a))&&n._isMounted&&n.setState(function(e){return{newThing:Ee({},e.newThing,{metadata:Ee({},e.newThing.metadata,{mac:a})}),isThingMacDisabled:!1}}):n.setState({isThingMacDisabled:!0})},n.handleChangeCycle=function(e){var t=e.target.value;n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{cycle:t}),isEnabled:e.config.cycle.length<=4&&/^\d+$/.test(e.config.cycle)}})},n.handleChangeSendToApp=function(e,t){var a=t.checked;n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{sendToApp:a})}}),n.getConnections()},n.handleChangeSendToDB=function(e,t){var a=t.checked;n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{sendToDB:a})}})},n.handleChangeDeviceType=function(e,t){var a=t.value;n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{deviceType:a})}})},n.handleChangeApp=function(e,t){var a=t.value;n._isMounted&&n.setState(function(e){return{config:Ee({},e.config,{app:a})}})},n.handleChangeNewDevice=function(e){var t=n.state.newDevice;if(n._isMounted){var a=Ee({},t);a[Object.keys(e)[0]]=e[Object.keys(e)[0]],n.setState({newDevice:a})}},n.state={deviceTypes:[],apps:[],oldThings:[],oldConnections:[],isEnabled:!0,showModalCreateDevice:!1,isThingMacDisabled:!1,isConnectionNameDisabled:!1,newThing:{name:"",metadata:{type:"device",mac:""}},config:{id:"",channel:[],name:"",cycle:"",sendToApp:!1,sendToDB:!1,deviceType:void 0,app:void 0},newDevice:{id:"",title:Ce.title,subtitle:Ce.subtitle,assettext:Ce.assettext,assetvalue:Ce.assetvalue,longitude:"",latitude:"",severity:"",alertext:"",alertvalue:"",messagetext:""}},n.oldThings=[],n.regexpName=/^\w+$/,n.regexpMac=/^[0-9a-z]{1,2}([.:-])(?:[0-9a-z]{1,2}\1){4}[0-9a-z]{2}$/gim,n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.getThings(),this.getConnections(),this.getDeviceTypes()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e!==this.props&&(this.getConnections(),this.getThings())}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props.showModalCreateDevice,n=this.state,a=n.isThingMacDisabled,c=n.isConnectionNameDisabled,r=n.isEnabled,i=n.deviceTypes,l=n.apps,s=n.config,u=n.newDevice;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},o.a.createElement(ue.a.Header,null," CREATE DEVICE "),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Name"),o.a.createElement("input",{placeholder:"name",onChange:function(t){return e.handleChangeConnectionName(t)},className:c?"show_error":""})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Mac"),o.a.createElement("input",{placeholder:"mac",onChange:function(t){return e.handleChangeThingMac(t)},className:a?"show_error":""})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Device type"),o.a.createElement(te.a,{placeholder:"type",fluid:!0,selection:!0,options:i,onChange:this.handleChangeDeviceType})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Cycle"),o.a.createElement("input",{placeholder:"cycle",className:r?"showSuccess":"showError",onChange:function(t){return e.handleChangeCycle(t)}})),o.a.createElement(de.a.Field,null,o.a.createElement(be.a,{label:s.sendToApp?"This device will be sent to App":"Click checkbox for send this config to App",onChange:this.handleChangeSendToApp}),o.a.createElement(be.a,{label:s.sendToDB?"This device have additional info":"Click checkbox for additional info",onChange:this.handleChangeSendToDB})),o.a.createElement(de.a.Field,{className:s.sendToApp?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Apps"),o.a.createElement(te.a,{placeholder:"apps",fluid:!0,selection:!0,options:l,onChange:this.handleChangeApp})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Title"),o.a.createElement("input",{placeholder:"Device title",onChange:function(t){return e.handleChangeNewDevice({title:t.target.value})},value:u.title})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Subtitle"),o.a.createElement("input",{placeholder:"Device subtitle",onChange:function(t){return e.handleChangeNewDevice({subtitle:t.target.value})},value:u.subtitle})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Latitude"),o.a.createElement("input",{placeholder:"Device latitude",onChange:function(t){return e.handleChangeNewDevice({latitude:t.target.value})}})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Longitude"),o.a.createElement("input",{placeholder:"Device longitude",onChange:function(t){return e.handleChangeNewDevice({longitude:t.target.value})}})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Asset text"),o.a.createElement("input",{placeholder:"Asset text",onChange:function(t){return e.handleChangeNewDevice({assettext:t.target.value})},value:u.assettext})),o.a.createElement(de.a.Field,{className:s.sendToDB?"":"hide"},o.a.createElement("label",{htmlFor:"mainflux_key"},"Asset value"),o.a.createElement("input",{placeholder:"Asset value",onChange:function(t){return e.handleChangeNewDevice({assetvalue:t.target.value})},value:u.assetvalue})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:this.close},"Cancel"),o.a.createElement(ce.a,{positive:!0,icon:"plus",labelPosition:"right",content:"Create",disabled:a||c||!r,onClick:this.createDeviceConnection})))}}]),t}(a.Component);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _e={title:"Turbine",subtitle:"LM2500",assettext:"MTU",assetvalue:"operation"},ke={log:function(e){return console.log(e)}},Te=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getConfigById=function(){var e=Object(W.a)(B.a.mark(function e(t){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(t),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var t=e.content.app,a=e.content.device_type,o=e.content.sendToApp,c=e.content.sendToDB;n._isMounted&&n.setState({selectedApp:t,selectedDeviceType:a,config:e,handleSendToApp:o,handleSendToDB:c})}).catch(function(e){return ke.log(e)});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getConnections=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/bootstrap"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=e.filter(function(e){return e.content=JSON.parse(e.content),"app"===e.content.type}).map(function(e){return{value:e.external_id,text:e.name.split(".")[0]}});n._isMounted&&n.setState({apps:t,oldConnections:e})}).catch(function(e){return ke.log(e)});case 2:case"end":return e.stop()}},e)})),n.getDeviceTypes=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://134.209.240.215:8300/devices").then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return{text:e,value:e}});n._isMounted&&n.setState({deviceTypes:t})}).catch(function(e){return ke.log(e)});case 1:case"end":return e.stop()}},e)})),n.getChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var a,o,c,r;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.oldConnections,o=a.filter(function(e){return e.external_id===t}),e.next=4,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return ke.log(e)});case 4:return c=e.sent,r=c.filter(function(e){return e.name===o[0].name}),e.abrupt("return",r[0]);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getGlobalChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var n,a;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return ke.log(e)});case 2:return n=e.sent,a=n.filter(function(e){return e.name==="zsse/".concat(t)}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.getDeviceInfoFromDB=function(){var e=Object(W.a)(B.a.mark(function e(t){var a,o,c,r,i,l,s,u,d,h,p,m;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/device/").concat(t),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).catch(function(e){return ke.log(e)});case 2:a=e.sent,o=a.id,c=a.title,r=a.subtitle,i=a.severity,l=a.alerttext,s=a.alertvalue,u=a.assettext,d=a.assetvalue,h=a.messagetext,p=a.longitude,m=a.latitude,n.setState(function(e){return{editDevice:xe({},e.editDevice,{id:o,title:c,subtitle:r,severity:i,alerttext:l,alertvalue:s,assettext:u,assetvalue:d,messagetext:h,longitude:p,latitude:m})}});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=n.props.callbackFromParent,t=n.state.showModalEditDevice;n._isMounted&&n.setState({showModalEditDevice:!1}),e(t)},n.editDevice=Object(W.a)(B.a.mark(function e(){var t,a,o,c,r,i,l,s,u,d,h,p,m,f,v,g,b,y,E,C,O,w,j,x,_,k,T,D,M,S,N,P,A,F,R,U,G,I,L,J;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,a=t.config,o=t.oldConnections,c=t.handleSendToApp,r=t.handleSendToDB,i=t.editDevice,l=a.content,s=l.name,u=l.cycle,d=l.deviceType,h=l.app,p=l.sendToApp,m=l.sendToDB,f=l.mac,v={},e.next=5,fetch("".concat("http://localhost:5000","/api/things/").concat(a.mainflux_id),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(){var e=Object(W.a)(B.a.mark(function e(t){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/things/edit/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({name:s,metadata:t.metadata})});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 5:if(g={},!c){e.next=13;break}return e.next=9,n.getChannel(h);case 9:g=e.sent,v={type:"device",id:a.mainflux_id,mac:f,channel:g.id,sendToApp:c,sendToDB:r,name:s,cycle:u,deviceType:d,app:h},e.next=17;break;case 13:return e.next=15,n.getGlobalChannel("global_channel");case 15:g=e.sent,v={type:"device",id:a.mainflux_id,mac:f,channel:g.id,sendToApp:c,sendToDB:r,name:s,deviceType:d,cycle:u};case 17:return e.next=19,fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:v})});case 19:return e.next=21,fetch("".concat("http://localhost:5000","/api/bootstrap/edit/channels/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({obj:v})});case 21:if(!0!==m||!1!==r){e.next=26;break}return e.next=24,fetch("".concat("http://localhost:5000","/api/device/remove/").concat(i.id.split("/")[1]),{method:"DELETE",mode:"cors",credentials:"include"}).catch(function(e){return ke.log(e)});case 24:e.next=38;break;case 26:if(!1!==m||!0!==r){e.next=33;break}return b=i.title,y=i.subtitle,E=i.severity,C=i.alerttext,O=i.alertvalue,w=i.assettext,j=i.assetvalue,x=i.messagetext,_=i.longitude,k=i.latitude,T={id:a.content.name.split("/")[1],title:b,subtitle:y,severity:E,alerttext:C,alertvalue:O,assettext:w,assetvalue:j,messagetext:x,longitude:_,latitude:k},e.next=31,fetch("".concat("http://localhost:5000","/api/device/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(T)});case 31:e.next=38;break;case 33:if(!0!==m||!0!==r){e.next=38;break}return D=i.id,M=i.title,S=i.subtitle,N=i.severity,P=i.alerttext,A=i.alertvalue,F=i.assettext,R=i.assetvalue,U=i.messagetext,G=i.longitude,I=i.latitude,L={id:a.content.name.split("/")[1],title:M,subtitle:S,severity:N,alerttext:P,alertvalue:A,assettext:F,assetvalue:R,messagetext:U,longitude:G,latitude:I},e.next=38,fetch("".concat("http://localhost:5000","/api/device/update/").concat(D),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(L)});case 38:if(!0!==p||!1!==c){e.next=45;break}return e.next=41,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(h),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var t=e.content;t.devices=t.devices.filter(function(e){return e.device_id!==a.mainflux_id}),fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 41:return e.next=43,fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(g.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 43:return n.close(),e.abrupt("return");case 45:if(!1!==p||!0!==c){e.next=52;break}return e.next=48,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(h),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content),e.content.devices.push({device_name:"zsse/".concat(v.name),device_id:a.mainflux_id,device_key:a.mainflux_key,device_type:v.device_type}),fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 48:return e.next=50,fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(g.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 50:return e.next=52,n.getConnections();case 52:if(!p){e.next=59;break}if((J=o.filter(function(e){return e.mainflux_id===a.mainflux_id}))[0].content.app===v.app){e.next=57;break}return e.next=57,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(J[0].content.app),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var t=e.content;t.devices=t.devices.filter(function(e){return e.device_id!==J[0].mainflux_id}),fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(g.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 57:return e.next=59,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(h),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var t=e.content,n=t.devices.filter(function(e){return e.device_id===a.mainflux_id});if(0===n.length)t.devices.push({device_name:s,device_id:a.mainflux_id,device_key:a.mainflux_key,deviceType:d});else{var o=t.devices.indexOf(n[0]);t.devices[o]={device_name:s,device_id:a.mainflux_id,device_key:a.mainflux_key,deviceType:d}}fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})}),fetch("".concat("http://localhost:5000","/api/connection/create/channels/").concat(g.id,"/things/").concat(a.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"})});case 59:n.close();case 60:case"end":return e.stop()}},e)})),n.handleChangeConnectionName=function(e){var t=n.state.oldConnections,a=e.target.value,o=t.filter(function(e){return e.name==="zsse/".concat(a)});0!==o.length&&n._isMounted?n.setState({isConnectionNameDisabled:!0}):0===o.length&&n._isMounted&&n.setState(function(e){return{config:xe({},e.config,{content:xe({},e.config.content,{name:a})}),isConnectionNameDisabled:!1}})},n.handleChangeCycle=function(e){var t=e.target.value;n._isMounted&&n.setState(function(e){return{config:xe({},e.config,{content:xe({},e.config.content,{cycle:t})}),isEnabled:e.config.content.cycle.length<=4&&/^\d+$/.test(e.config.content.cycle)}})},n.handleChangeDeviceType=function(e,t){var a=t.value,o=a;n._isMounted&&n.setState(function(e){return{config:xe({},e.config,{content:xe({},e.config.content,{device_type:o})}),selectedDeviceType:a}})},n.handleChangeSendToApp=function(e,t){var a=t.checked;n._isMounted&&n.setState({handleSendToApp:a}),n.getConnections()},n.handleChangeSendToDB=function(e,t){var a=t.checked;n._isMounted&&n.setState({handleSendToDB:a})},n.handleChangeApp=function(e,t){var a=t.value,o=a;n._isMounted&&n.setState(function(e){return{config:xe({},e.config,{content:xe({},e.config.content,{app:o})}),selectedApp:a}})},n.handleChangeEditDevice=function(e){var t=n.state.editDevice;if(n._isMounted){var a=xe({},t);a[Object.keys(e)[0]]=e[Object.keys(e)[0]],n.setState({editDevice:a})}},n.state={showModalEditDevice:!1,isEnabled:!0,deviceTypes:[],apps:[],config:{},selectedDeviceType:"",selectedApp:"",oldConnections:[],isConnectionNameDisabled:!1,handleSendToApp:void 0,handleSendToDB:void 0,editDevice:{id:"",title:_e.title,subtitle:_e.subtitle,latitude:"",longitude:"",assettext:_e.assettext,assetvalue:_e.assetvalue,severity:"",alerttext:"",alertvalue:"",messagetext:""}},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=this.props.connection,n=t.externalId,a=t.name,o=t.content;this.getConfigById(n),this.getThings().then(function(){e._isMounted&&e.forceUpdate()}),this.getDeviceTypes(),this.getConnections(),o.sendToDB&&this.getDeviceInfoFromDB(a.split("/")[1])}},{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props.showModalEditDevice,n=this.state,a=n.config,c=n.isEnabled,r=n.deviceTypes,i=n.apps,l=n.selectedDeviceType,s=n.selectedApp,u=n.isConnectionNameDisabled,d=n.handleSendToApp,h=n.handleSendToDB,p=n.editDevice,m=p.title,f=p.subtitle,v=p.assettext,g=p.assetvalue,b=p.longitude,y=p.latitude;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},o.a.createElement(ue.a.Header,null,"EDIT DEVICE"),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_id"},"Thing ID"),o.a.createElement("input",{placeholder:"mainflux_id",value:void 0!==a.content?a.mainflux_id:"",readOnly:!0})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Thing Key"),o.a.createElement("input",{placeholder:"mainflux_key",value:void 0!==a.content?a.mainflux_key:"",readOnly:!0})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"}," Name "),o.a.createElement("input",{placeholder:"name",onChange:function(t){return e.handleChangeConnectionName(t)},value:void 0!==a.content?a.content.name:"",className:u?"show_error":""})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"cycle"}," Cycle "),o.a.createElement("input",{placeholder:"cycle",value:void 0!==a.content?a.content.cycle:"",className:c?"showSuccess":"showError",onChange:function(t){return e.handleChangeCycle(t)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"device_type"}," Device Type "),o.a.createElement(te.a,{placeholder:"device type",fluid:!0,selection:!0,options:r,value:l,onChange:this.handleChangeDeviceType})),o.a.createElement(de.a.Field,null,o.a.createElement(be.a,{label:d?"This device's config sent to App":"Click checkbox for send this device's config to App",onChange:this.handleChangeSendToApp,checked:d}),o.a.createElement(be.a,{label:h?"This device have additional info":"Click checkbox for additional info",onChange:this.handleChangeSendToDB,checked:h})),o.a.createElement(de.a.Field,{className:d?"":"hide"},o.a.createElement("label",{htmlFor:"apps"},"Apps"),o.a.createElement(te.a,{placeholder:"apps",fluid:!0,selection:!0,options:i,onChange:this.handleChangeApp,value:s})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"title"},"Title"),o.a.createElement("input",{placeholder:"Device title",onChange:function(t){return e.handleChangeEditDevice({title:t.target.value})},value:void 0!==m?m:""})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"subtitle"},"Subtitle"),o.a.createElement("input",{placeholder:"Device subtitle",onChange:function(t){return e.handleChangeEditDevice({subtitle:t.target.value})},value:void 0!==f?f:""})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"latitude"},"Latitude"),o.a.createElement("input",{placeholder:"Device latitude",onChange:function(t){return e.handleChangeEditDevice({latitude:t.target.value})},value:void 0!==y?y:""})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"longitude"},"Longitude"),o.a.createElement("input",{placeholder:"Device longitude",onChange:function(t){return e.handleChangeEditDevice({longitude:t.target.value})},value:void 0!==b?b:""})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"asset_text"},"Asset text"),o.a.createElement("input",{placeholder:"Asset text",onChange:function(t){return e.handleChangeEditDevice({assettext:t.target.value})},value:void 0!==v?v:""})),o.a.createElement(de.a.Field,{className:h?"":"hide"},o.a.createElement("label",{htmlFor:"asset_value"},"Asset value"),o.a.createElement("input",{placeholder:"Asset value",onChange:function(t){return e.handleChangeEditDevice({assetvalue:t.target.value})},value:void 0!==g?g:""})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:this.close},"No"),o.a.createElement(ce.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:this.editDevice,disabled:u||!c})))}}]),t}(a.Component),De={log:function(e){return console.log(e)}},Me=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.getChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var n,a;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/channels"),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return De.log(e)});case 2:return n=e.sent,a=n.filter(function(e){return e.name===t}),e.abrupt("return",a[0]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.removeConnection=function(){var e=Object(W.a)(B.a.mark(function e(t){var a,o,c,r,i,l,s;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.callbackFromParent,o=n.state.showModalRemove,c=t.content,r=c.sendToApp,i=c.app,l=c.type,fetch("".concat("http://localhost:5000","/api/things/remove/").concat(t.mainflux_id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),fetch("".concat("http://localhost:5000","/api/bootstrap/remove/").concat(t.mainflux_id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),fetch("".concat("http://localhost:5000","/api/device/remove/").concat(t.mainflux_id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),!r){e.next=9;break}return e.next=9,fetch("".concat("http://localhost:5000","/api/bootstrap/").concat(i),{mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.content=JSON.parse(e.content);var n=e.content;n.devices=n.devices.filter(function(e){return e.device_id!==t.mainflux_id}),fetch("".concat("http://localhost:5000","/api/bootstrap/edit/info/").concat(e.mainflux_id),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({response:e})})});case 9:if("app"!==l){e.next=14;break}return e.next=12,n.getChannel(t.name);case 12:s=e.sent,fetch("".concat("http://localhost:5000","/api/channels/remove/").concat(s.id),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"});case 14:n._isMounted&&n.setState({showModalRemove:!1}),a(o,t.mainflux_id);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=n.props.callbackFromParent,t=n.state.showModalRemove;n._isMounted&&n.setState({showModalRemove:!1,isRemoveable:!0},function(){e(t)})},n.state={showModalRemove:!1,isRemoveable:!0},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.connection.content;void 0!==t&&"app"===t.type&&0!==t.devices.length&&this._isMounted?this.setState({isRemoveable:!1}):void 0!==t&&"app"!==t.type&&0===t.devices.length&&this._isMounted&&this.setState({isRemoveable:!0})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props,n=t.showModalRemove,a=t.connection,c=this.state.isRemoveable;return o.a.createElement(ue.a,{basic:!0,size:"small",open:n},o.a.createElement(ee.a,{icon:"archive",content:c?"REMOVE CONNECTION?":"CAN NOT REMOVE CONNECTION"}),o.a.createElement(ue.a.Content,null,o.a.createElement("p",null,c?"Do you want to remove connection: ".concat(a.name):"CONNECTION '".concat(a.name,"' HAVE CONNECTED DEVICES. FIRST REMOVE CONNECTED DEVICES."))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},o.a.createElement(re.a,{name:"remove"})," ","No"),o.a.createElement(ce.a,{color:"red",inverted:!0,onClick:function(){return c?e.removeConnection(a):e.close()}},o.a.createElement(re.a,{name:"checkmark"})," ","Yes")))}}]),t}(a.Component),Se=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).close=function(){n.setState({showModalRemove:!1}),n.props.callbackFromParent(n.state.showModalError)},n.state={showModalError:!1},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showModalError,n=e.errorText;return o.a.createElement(ue.a,{basic:!0,size:"small",open:t},o.a.createElement(ee.a,{icon:"archive",content:"ERROR"}),o.a.createElement(ue.a.Content,null,o.a.createElement("p",null,n)),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},o.a.createElement(re.a,{name:"remove"})," Close")))}}]),t}(a.Component),Ne={log:function(e){return console.log(e)}},Pe=function(e){function t(){var e;return Object(D.a)(this,t),(e=Object(S.a)(this,Object(N.a)(t).call(this)))._isMounted=!1,e.getToken=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("".concat("http://localhost:5000","/api/users/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({email:"".concat("zeinetsse11@email.com")})});case 1:case"end":return e.stop()}},e)})),e.getConnections=Object(W.a)(B.a.mark(function t(){return B.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:5000","/api/bootstrap"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(t){var n=t.map(function(e){return e.content=JSON.parse(e.content),e});e._isMounted&&e.setState({connections:n,loader:!1})}).catch(function(e){return Ne.log(e)});case 2:case"end":return t.stop()}},t)})),e.createAppModalCallback=function(t,n){e._isMounted&&e.setState({showModalCreateApp:t,connections:n}),e.getConnections()},e.createDeviceModalCallback=function(t,n){e._isMounted&&e.setState({showModalCreateDevice:t,connections:n}),e.getConnections()},e.removeModalCallback=function(t,n){var a=e.state.connections;if(e._isMounted&&e.setState({showModalRemove:t}),n){var o=a.filter(function(e){return e.mainflux_id===n})[0].content,c=o.type,r=o.app;if("device"===c&&void 0!==r){var i=a.filter(function(e){return e.external_id===r}),l=i[0].content.devices.filter(function(e){return e.device_id!==n});a[a.indexOf(i[0])].content.devices=l,e._isMounted&&e.setState({connections:a})}e._isMounted&&e.setState({connections:a.filter(function(e){return e.mainflux_id!==n})})}},e.editAppModalCallback=function(t){e._isMounted&&e.setState({showModalEditApp:t}),e.getConnections()},e.editDeviceModalCallback=function(t){e._isMounted&&e.setState({showModalEditDevice:t}),e.getConnections()},e.errorModalCallback=function(t){e._isMounted&&e.setState({showModalError:t})},e.state={connections:[],showModalCreateApp:!1,showModalEditApp:!1,showModalCreateDevice:!1,showModalEditDevice:!1,showModalError:!1,edittingApp:{},edittingDevice:{},removingConnection:{},errorText:"",loader:!0},e}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.getToken(),this.getConnections()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e!==this.props&&this.getConnections()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.connections,a=t.showModalCreateApp,c=t.showModalCreateDevice,r=t.showModalRemove,i=t.showModalEditApp,l=t.showModalEditDevice,s=t.showModalError,u=t.edittingApp,d=t.edittingDevice,h=t.removingConnection,p=t.errorText,m=t.loader;return o.a.createElement("div",{id:"connections",className:"main_wrapper"},o.a.createElement("div",{className:"connection_top"},o.a.createElement("h1",null," Connections "),o.a.createElement("div",{className:"connection_btn__wrapper"},o.a.createElement(ce.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreateApp:!0})}},o.a.createElement(re.a,{name:"chain"}),"Create App"),o.a.createElement(ce.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreateDevice:!0})}},o.a.createElement(re.a,{name:"chain"}),"Create Device"))),o.a.createElement("hr",null),o.a.createElement(ie.a.Group,{relaxed:!0},o.a.createElement(le.a,{active:m,content:"Loading"}),0===n.length?o.a.createElement("p",null,"Unfortunately we did not find your connections. It will be great to create some.",o.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")):n.map(function(t){return o.a.createElement(ie.a,{key:t.mainflux_id},o.a.createElement(ie.a.Content,{verticalAlign:"middle"},o.a.createElement(se.a,{content:o.a.createElement("div",null,o.a.createElement("p",null,"id:"," ",t.mainflux_id),o.a.createElement("p",null,"key:"," ",t.mainflux_key)),trigger:o.a.createElement(ie.a.Header,null,t.name)}),o.a.createElement(ie.a.Description,null,t.content.type),o.a.createElement(ie.a.Description,null,t.external_id),o.a.createElement(ie.a.Extra,null,o.a.createElement(ce.a,{color:"red",floated:"right",icon:"trash alternate outline",labelPosition:"right",content:"Remove",onClick:function(){return e.setState({showModalRemove:!0,removingConnection:t})}}),o.a.createElement(ce.a,{color:"yellow",floated:"right",icon:"edit outline",labelPosition:"right",content:"Edit",onClick:function(){return"app"===t.content.type?e.setState({showModalEditApp:!0,edittingApp:t}):e.setState({showModalEditDevice:!0,edittingDevice:t})}}))))})),a?o.a.createElement(fe,{showModalCreateApp:a,callbackFromParent:this.createAppModalCallback}):null,c?o.a.createElement(we,{showModalCreateDevice:c,callbackFromParent:this.createDeviceModalCallback}):null,r?o.a.createElement(Me,{showModalRemove:r,connection:h,callbackFromParent:this.removeModalCallback}):null,s?o.a.createElement(Se,{showModalError:s,errorText:p,callbackFromParent:this.errorModalCallback}):null,i?o.a.createElement(ge,{showModalEditApp:i,connection:u,callbackFromParent:this.editAppModalCallback}):null,l?o.a.createElement(Te,{showModalEditDevice:l,connection:d,callbackFromParent:this.editDeviceModalCallback}):null)}}]),t}(a.Component);n(181);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Re=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).createChannel=Object(W.a)(B.a.mark(function e(){var t;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.state.channel,fetch("".concat("http://localhost:5000","/api/channels/create"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({channel:t})}),n.close();case 3:case"end":return e.stop()}},e)})),n.close=function(){var e=n.props.callbackFromParent,t=n.state.showModalCreate;n.setState({showModalCreate:!1}),e(t)},n.handleChangeName=function(e){var t=e.target.value;n.setState(function(e){return{channel:Fe({},e.channel,{name:t})}})},n.state={showModalCreate:!1,channel:{name:"",metadata:{}}},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=this.props.showModalCreate,n=this.state.name;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:this.close},o.a.createElement(ue.a.Header,null,"CREATE THING"),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Name"),o.a.createElement("input",{placeholder:"name",value:n,onChange:function(t){return e.handleChangeName(t)}})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:this.close},"No"),o.a.createElement(ce.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:function(){return e.createChannel(n)}})))}}]),t}(a.Component),Ue=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).removeChannel=function(){var e=Object(W.a)(B.a.mark(function e(t){var a,o;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.props.callbackFromParent,o=n.state.showModalRemove,fetch("".concat("http://localhost:5000","/api/channels/remove/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}),n.setState({showModalRemove:!1}),a(o,t);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=n.props.callbackFromParent,t=n.state.showModalRemove;n.setState({showModalRemove:!1}),e(t)},n.state={showModalRemove:!1},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.showModalRemove,a=t.channel;return o.a.createElement(ue.a,{basic:!0,size:"small",open:n},o.a.createElement(ee.a,{icon:"archive",content:"REMOVE CHANNEL?"}),o.a.createElement(ue.a.Content,null,o.a.createElement("p",null,"Do you want to remove channel:"," ",a.name)),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{basic:!0,color:"green",inverted:!0,onClick:this.close},o.a.createElement(re.a,{name:"remove"})," ","No"),o.a.createElement(ce.a,{color:"red",inverted:!0,onClick:function(t){e.removeChannel(a.id,t)}},o.a.createElement(re.a,{name:"checkmark"})," ","Yes")))}}]),t}(a.Component),Be=function(e){function t(){var e;return Object(D.a)(this,t),(e=Object(S.a)(this,Object(N.a)(t).call(this))).getToken=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:5000","/api/users/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({email:"".concat("zeinetsse11@email.com")})});case 2:case"end":return e.stop()}},e)})),e.getChannels=Object(W.a)(B.a.mark(function t(){return B.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat("http://localhost:5000","/api/channels"),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(t){return e.setState({channels:t,loader:!1})}).catch(function(e){return e});case 2:case"end":return t.stop()}},t)})),e.removeModalCallback=function(t,n){e.setState({showModalRemove:t}),n&&e.setState(function(e){return{channels:e.channels.filter(function(e){return e.id!==n})}})},e.createChannelModalCallback=function(){var t=Object(W.a)(B.a.mark(function t(n){return B.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({showModalCreate:n}),t.next=3,e.getChannels();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.state={channels:[],removingChannel:{},showModalRemove:!1,showModalCreate:!1,loader:!0},e}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(B.a.mark(function e(){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getToken();case 2:this.getChannels();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.channels,a=t.showModalCreate,c=t.showModalRemove,r=t.removingChannel,i=t.loader;return o.a.createElement("div",{id:"channels",className:"main_wrapper"},o.a.createElement("div",{className:"channel_top"},o.a.createElement("h1",null,"Channels"),o.a.createElement(ce.a,{icon:!0,labelPosition:"left",onClick:function(){return e.setState({showModalCreate:!0})}},o.a.createElement(re.a,{name:"podcast"}),"Create Channel")),o.a.createElement("hr",null),o.a.createElement(ie.a.Group,{relaxed:!0},o.a.createElement(le.a,{active:i,content:"Loading"}),0===n.length?o.a.createElement("p",null,"Unfortunately we did not find your channels.",o.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")):n.map(function(t){return o.a.createElement(ie.a,{key:t.id},o.a.createElement(ie.a.Content,{verticalAlign:"middle"},o.a.createElement(ie.a.Header,null,t.name),o.a.createElement(ie.a.Description,null,t.id),o.a.createElement(ie.a.Extra,null,o.a.createElement(ce.a,{color:"red",floated:"right",icon:"trash alternate outline",labelPosition:"right",content:"Remove",onClick:function(){return e.setState({showModalRemove:!0,removingChannel:t})}}))))})),c?o.a.createElement(Ue,{showModalRemove:c,channel:r,callbackFromParent:this.removeModalCallback}):null,a?o.a.createElement(Re,{showModalCreate:a,callbackFromParent:this.createChannelModalCallback}):null)}}]),t}(a.Component),We=function(e){return function(t){t({type:v,payload:e})}},Ge=function(e){return function(t){t({type:g,payload:e})}},Ie=function(e){return function(t){t({type:y});var n=e.device,a=e.date,o=e.parameter;fetch("".concat("http://localhost:5000","/api/data/"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({device:n,date:36e5*a,parameter:o})}).then(function(e){return e.json()}).then(function(e){var n,a=e.map(function(e){return Object(d.a)({name:new Date(1e3*e.time).toLocaleTimeString().replace(" AM","").replace(" PM","")},o,e[o])});return t((n=a,{type:E,payload:Object(u.a)(n)}))}).catch(function(e){return t({type:C,payload:{error:e}})})}};n(523),n(275);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ze=[{key:0,text:"Timeseries",value:"timeseries"},{key:1,text:"KPI",value:"kpi"},{key:2,text:"Table",value:"table"}],He=[{key:0,text:"1 hour",value:1},{key:1,text:"3 hours",value:3},{key:2,text:"6 hours",value:6},{key:3,text:"12 hours",value:12},{key:4,text:"24 hours",value:24},{key:5,text:"5 days",value:120},{key:6,text:"10 days",value:240},{key:7,text:"15 days",value:360}],Ve=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).handleChangeData=function(e,t,a){var o=t.target.value;void 0!==o?n.setState(function(t){return{config:Je({},t.config,Object(d.a)({},e,o))}}):n.setState(function(t){return{config:Je({},t.config,Object(d.a)({},e,a))}})},n.handleSubmit=function(){var e=n.props,t=e.addGraphData,a=e.showGraphActionWindow,o=e.addGraphConfig,c=n.state.config;o(c),t(c),a(!1)},n.onClose=function(){var e=n.props.showGraphActionWindow,t=n.state.isVisible;n.setState({isVisible:!1}),e(t)},n.state={isVisible:!1,config:{title:"",type:"",device:"",date:"",parameter:""}},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=this.props.showEditWindow,n=this.state.config;return o.a.createElement(ue.a,{closeIcon:!0,dimmer:"blurring",open:t,onClose:function(){return e.onClose()}},o.a.createElement(ue.a.Header,null,n.title," ","Graph"),o.a.createElement(ue.a.Content,null,o.a.createElement(de.a,null,o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Title"),o.a.createElement("input",{placeholder:"title",value:n.title,onChange:function(t){return e.handleChangeData("title",t)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"mainflux_key"},"Type"),o.a.createElement(te.a,{placeholder:"types",fluid:!0,selection:!0,options:ze,value:n.type,onChange:function(t,n){var a=n.value;return e.handleChangeData("type",t,a)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Device name"),o.a.createElement("input",{placeholder:"device name",value:n.device,onChange:function(t){return e.handleChangeData("device",t)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Parameter"),o.a.createElement("input",{placeholder:"parameter",value:n.parameter,onChange:function(t){return e.handleChangeData("parameter",t)}})),o.a.createElement(de.a.Field,null,o.a.createElement("label",{htmlFor:"name"},"Date"),o.a.createElement(te.a,{placeholder:"date",fluid:!0,selection:!0,options:He,value:n.date,onChange:function(t,n){var a=n.value;return e.handleChangeData("date",t,a)}})))),o.a.createElement(ue.a.Actions,null,o.a.createElement(ce.a,{color:"black",onClick:function(){return e.onClose()}},"No"),o.a.createElement(ce.a,{positive:!0,icon:"edit outline",labelPosition:"right",content:"Yes",onClick:function(){return e.handleSubmit()}})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.showEditWindow!==t.isVisible?{isVisible:!0,config:{title:e.graphTitle,type:e.graphType,device:e.deviceName,parameter:e.deviceParameter,date:e.requestDate}}:null}}]),t}(a.Component);var Ke=Object(i.b)(function(e){return{graph:e.config}},function(e){return{showGraphActionWindow:function(t){return e(We(t))},addGraphConfig:function(t){return e(Ge(t))},addGraphData:function(t){return e(Ie(t))}}})(Ve),$e=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).toggleComponent=function(){var e=n.state.opened;n.setState({opened:!e})},n.state={opened:!1},T.subscribe(function(){n.setState({opened:T.getState().graph.showGraphActionWindow})}),n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.props.children,t=this.state.opened;return o.a.createElement("div",{className:"component"},t&&o.a.createElement("div",{className:"componentContent"},e))}}]),t}(a.Component),Ye=n(321),Xe=n(56);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ze=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).handleMouseEnter=function(e){var t=e.dataKey,a=n.state.opacity;n.setState({opacity:Qe({},a,Object(d.a)({},t,.5))})},n.handleMouseLeave=function(e){var t=e.dataKey,a=n.state.opacity;n.setState({opacity:Qe({},a,Object(d.a)({},t,1))})},n.state={opacity:{uv:1}},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){return e!==t}},{key:"shouldComponentUpdate",value:function(e){return e!==this.props}},{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,a=e.data,c=this.state.opacity,r=[];return"wait"===a[0]?o.a.createElement("p",null,"Waiting for data..."):(a.length>0&&(r=Object.keys(a[0]).filter(function(e){return"name"!==e})),o.a.createElement("div",{id:"timeseries",className:"disable-dragging"},o.a.createElement(Xe.e,{width:t-20,height:n-20,data:a,margin:{top:5,right:30,left:20,bottom:5}},o.a.createElement(Xe.b,{strokeDasharray:"3 3"}),o.a.createElement(Xe.g,{dataKey:"name"}),o.a.createElement(Xe.h,{type:"number",domain:[10,11]}),o.a.createElement(Xe.f,null),o.a.createElement(Xe.c,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),o.a.createElement(Xe.d,{type:"monotone",dataKey:r[0],strokeOpacity:c.pv,stroke:"#8884d8",activeDot:{r:8}}),o.a.createElement(Xe.a,null))))}}]),t}(a.Component),et=n(325),tt=n.n(et),nt=n(326),at=n.n(nt),ot=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).handleClick=function(e){var t=n.state.showEditWindow;"graph_edit__btn"===e.className?n.editWindow(!t):"graph_remove__btn"===e.className&&console.info("Remove button clicked...")},n.editWindow=function(e){n.setState({showEditWindow:e})},n.state={showEditWindow:!1},n.editBtnRef=o.a.createRef(),n.removeBtnRef=o.a.createRef(),n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.graphTitle,a=t.width,c=this.state.showEditWindow;return o.a.createElement("div",{id:"graph_wrapper__header",style:{borderTopLeftRadius:5,borderTopRightRadius:5,width:a}},o.a.createElement("div",{className:"graph_name"},o.a.createElement("h5",null,n)),o.a.createElement("div",{className:"graph_actions"},o.a.createElement("button",{type:"button",className:"graph_edit__btn",onClick:function(){return e.handleClick(e.editBtnRef.current)},ref:this.editBtnRef},o.a.createElement("img",{src:tt.a,alt:"Edit graph"})),o.a.createElement("button",{type:"button",className:"graph_remove__btn",onClick:function(){return e.handleClick(e.removeBtnRef.current)},ref:this.removeBtnRef},o.a.createElement("img",{src:at.a,alt:"Remove graph"}))),c?o.a.createElement(Ke,{showEditWindow:c,callbackFromParent:this.editWindow,graphTitle:n}):null)}}]),t}(a.Component);function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var rt=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e))).state={width:620,height:350},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){var e=T.getState().graph,t=e.defaultWidth,n=e.defaultHeight;this._isMounted=!0,this.setState({width:t,height:n})}},{key:"shouldComponentUpdate",value:function(e){return e!==this.props}},{key:"render",value:function(){var e,t=this,n=this.state,a=n.width,c=n.height,r=this.props,i=r.type,l=r.title,s=r.data;return e="timeseries"===i?o.a.createElement(Ze,{width:a,height:c-30,type:i,title:l,data:s}):o.a.createElement("h4",{style:{color:"red"}},"Error occured, please check the configs of this graph!"),o.a.createElement("div",{style:{margin:0,paddingBottom:"40px"}},o.a.createElement(Ye.a,{default:{x:0,y:0,width:a,height:c},style:{background:"#EBEFF2",position:"relative",padding:"10px",borderRadius:"5px"},onResize:function(e,n,a,o,c){t.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({width:parseInt(a.style.width,10),height:parseInt(a.style.height,10)},c))},cancel:".disable-dragging"},o.a.createElement(ot,{width:a-20,graphTitle:l}),e))}}]),t}(a.Component),it=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(S.a)(this,Object(N.a)(t).call(this,e)))._isMounted=!1,n.createGraph=function(){(0,n.props.showGraphActionWindow)(!T.getState().graph.showGraphActionWindow)},n.state={graphsConfigList:[],graphsData:[],loading:!1},T.subscribe(function(){var e=T.getState().graph,t=e.graphsConfigList,a=e.graphsData,o=e.loading;n.setState({graphsConfigList:t,graphsData:a,loading:o})}),n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){var e=T.getState().graph,t=e.graphsConfigList,n=e.graphsData,a=this.props.addGraphData;this._isMounted=!0,this.setState({graphsConfigList:t,graphsData:n}),t.forEach(function(){var e=Object(W.a)(B.a.mark(function e(t){return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a(t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"shouldComponentUpdate",value:function(){var e=T.getState().graph,t=this.state,n=t.graphsConfigList,a=t.graphsData;return e.graphsConfigList!==n||e.graphsData!==a}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this.state,t=e.graphsConfigList,n=e.graphsData,a=e.loading;return o.a.createElement("div",{id:"graphs",className:"main_wrapper"},o.a.createElement("div",{className:"graphs_header"},o.a.createElement("button",{type:"button",onClick:this.createGraph},"Create")),a?o.a.createElement("p",null,"LOADING..."):"",n.length>0?t.map(function(e,t){return o.a.createElement(rt,{key:t,title:e.title,type:e.type,data:n[t]||["wait"]})}):"",o.a.createElement($e,{title:"Show Component"},o.a.createElement(Ke,{showEditWindow:!0,graphTitle:"",graphType:"",deviceName:"",deviceParameter:"",requestDate:1})))}}]),t}(a.Component);var lt=Object(i.b)(function(e){return{graph:e.config}},function(e){return{showGraphActionWindow:function(t){return e(We(t))},addGraphData:function(t){return e(Ie(t))}}})(it),st=function(){return o.a.createElement("div",{className:"main_wrapper"},o.a.createElement("h1",null,"Nothing was found"),o.a.createElement("p",null,"Unfortunately we did not find anything for your request.",o.a.createElement("span",{role:"img","aria-label":"Sad"},"\ud83d\ude41")))},ut=function(e){function t(){var e,n;Object(D.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(S.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(o)))).checkActive=function(e){return"/"===e.url},n}return Object(P.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(oe,null),o.a.createElement(A.a,null,o.a.createElement("div",{id:"sidebar_wrapper"},o.a.createElement(R.a,{id:"sidebar_menu",secondary:!0,vertical:!0},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(A.b,{to:"/",activeClassName:"active_item",isActive:this.checkActive},"Home")),o.a.createElement("li",null,o.a.createElement(A.b,{to:"/channels",activeClassName:"active_item"},"Channels")),o.a.createElement("li",null,o.a.createElement(A.b,{to:"/connections",activeClassName:"active_item"},"Connections")),o.a.createElement("li",null,o.a.createElement(A.b,{to:"/graphs",activeClassName:"active_item"},"Graphs")))),o.a.createElement(F.c,null,o.a.createElement(F.a,{exact:!0,path:"/",component:q}),o.a.createElement(F.a,{path:"/channels",component:Be}),o.a.createElement(F.a,{path:"/connections",component:Pe}),o.a.createElement(F.a,{path:"/graphs",component:lt}),o.a.createElement(F.a,{component:st})))))}}]),t}(a.Component),dt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ht(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(o.a.createElement(i.a,{store:T},o.a.createElement(ut,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");dt?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ht(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ht(t,e)})}}()},86:function(e,t,n){}},[[365,1,2]]]);
//# sourceMappingURL=main.bc1396a7.chunk.js.map